<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Reborn Companion (PWA) ‚Äî Debug</title>
  <meta name="theme-color" content="#F7A8B8">
  <style>
    body { margin: 0; background: #fff; font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue"; }
    .splash { position: fixed; inset: 0; display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg, #F7A8B8 0%, #B6E3C6 100%); color: #3A3A3A; }
    .hide { display: none; }
    .log { position: fixed; bottom: 0; left: 0; right: 0; background: #000; color: #0f0; font: 12px/1.4 monospace; max-height: 40vh; overflow:auto; padding: 8px; }
  </style>
</head>
<body>
  <div id="splash" class="splash"><h1>üçº Reborn Companion</h1></div>
  <pre id="log" class="log"></pre>

  <!-- stlite -->
  <script src="https://cdn.jsdelivr.net/npm/stlite@0.72.0/dist/stlite.js"></script>
  <script type="module">
    const log = (msg) => { const el = document.getElementById('log'); el.textContent += msg + "\\n"; console.log(msg); };
    const splash = document.getElementById('splash');
    log("Booting‚Ä¶");

    (async () => {
      try {
        log("Fetching app.py‚Ä¶");
        const resp = await fetch("./app.py?cb=" + Date.now());
        if (!resp.ok) throw new Error("Failed to fetch app.py: " + resp.status + " " + resp.statusText);
        const py = await resp.text();
        log("Loaded app.py (" + py.length + " bytes). Mounting‚Ä¶");
        const { mount } = await import("https://cdn.jsdelivr.net/npm/stlite@0.72.0/dist/stlite.mjs");
        await mount([{ path: "/app.py", content: py }], { entrypoint: "/app.py" });
        splash.classList.add('hide');
        log("Mounted successfully ‚úÖ");
      } catch (e) {
        log("Error: " + e.message);
        splash.innerHTML = "<div style='text-align:center'><h2>‚ö†Ô∏è Could not load the app.</h2><p>" + e.message + "</p></div>";
      }
    })();
  </script>
</body>
</html>
